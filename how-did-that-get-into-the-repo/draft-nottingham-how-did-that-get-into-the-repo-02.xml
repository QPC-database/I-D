<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.3.3 -->

<!DOCTYPE rfc SYSTEM "../Tools/rfcbootstrap/rfc2629.dtd" [
]>

<?rfc toc="yes"?>
<?rfc tocindent="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>
<?rfc strict="yes"?>
<?rfc compact="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>

<rfc ipr="trust200902" docName="draft-nottingham-how-did-that-get-into-the-repo-02" category="info">

  <front>
    <title>The secret-token URI Scheme</title>

    <author initials="M." surname="Nottingham" fullname="Mark Nottingham">
      <organization></organization>
      <address>
        <email>mnot@mnot.net</email>
        <uri>https://www.mnot.net/</uri>
      </address>
    </author>

    <date year="2020"/>

    <area>General</area>
    
    <keyword>Internet-Draft</keyword>

    <abstract>


<t>This document registers the “secret-token” URI scheme, to aid in the identification
of authentication tokens.</t>



    </abstract>


    <note title="Note to Readers">


<t><spanx style="emph">RFC EDITOR: please remove this section before publication</spanx></t>

<t>The issues list for this draft can be found at <eref target="https://github.com/mnot/I-D/labels/how-did-that-get-into-the-repo">https://github.com/mnot/I-D/labels/how-did-that-get-into-the-repo</eref>.</t>

<t>The most recent (often, unpublished) draft is at <eref target="https://mnot.github.io/I-D/how-did-that-get-into-the-repo/">https://mnot.github.io/I-D/how-did-that-get-into-the-repo/</eref>.</t>

<t>Recent changes are listed at <eref target="https://github.com/mnot/I-D/commits/gh-pages/how-did-that-get-into-the-repo">https://github.com/mnot/I-D/commits/gh-pages/how-did-that-get-into-the-repo</eref>.</t>

<t>See also the draft’s current status in the IETF datatracker, at
<eref target="https://datatracker.ietf.org/doc/draft-nottingham-how-did-that-get-into-the-repo/">https://datatracker.ietf.org/doc/draft-nottingham-how-did-that-get-into-the-repo/</eref>.</t>


    </note>


  </front>

  <middle>


<section anchor="introduction" title="Introduction">

<t>It has become increasingly common to use bearer tokens as an authentication mechanism in various
protocols.</t>

<t>A bearer token is a security token with the property that any party in possession of the token (a
“bearer”) can use the token in any way that any other party in possession of it can. Using a bearer
token does not require a bearer to prove possession of cryptographic key material
(proof-of-possession).</t>

<t>Unfortunately, the number of security incidents involving accidental disclosure of these tokens has also increased. For example, we now regularly hear about a developer committing an access token to a public source code repository, either because they didn’t realise it was included in the committed code, or because they didn’t realise the implications of its disclosure.</t>

<t>This specification registers the “secret-token” URI scheme to aid prevention of such accidental disclosures. When tokens are easier to unambiguously identify, they can trigger warnings in Continuous Integration systems, or be used in source code repositories themselves. They can also be scanned for separately.</t>

<t>For example, if cloud.example.net issues access tokens to its clients for later use, and it does so by formatting them as secret-token URIs, tokens that “leak” into places that they don’t belong are easier to identify. This could be through a variety of mechanisms; for example, if repo.example.com can be configured to refuse commits containing secret-token URIs, it helps its customers avoid accidental disclosures.</t>

<t>secret-token URIs are intended to aid in identification of generated secrets like API keys and similar tokens. They are not intended for use in controlled situations where ephemeral tokens are used, such as things like Cross-Site Request Forgery (CSRF) tokens.</t>

<section anchor="notational-conventions" title="Notational Conventions">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
“RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as
described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they appear in all capitals, as
shown here.</t>

<t>This document uses ABNF <xref target="RFC5234"/>. It also uses the pchar rule from <xref target="RFC3986"/>.</t>

</section>
</section>
<section anchor="the-secret-token-uri-scheme" title="The secret-token URI scheme">

<t>The secret-token URI scheme identifies a token that is intended to be a secret.</t>

<figure><artwork type="abnf"><![CDATA[
secret-token-URI    = secret-token-scheme ":" token
secret-token-scheme = "secret-token"
token               = 1*pchar
]]></artwork></figure>

<t>See <xref target="RFC3986"/>, Section 3.3 for a definition of pchar. Disallowed characters – including non-ASCII characters – MUST be encoded into UTF-8 <xref target="RFC3629"/> and then percent-encoded (<xref target="RFC3986"/>, Section 2.1).</t>

<t>When a token is both generated and presented for authentication, the entire URI MUST be used,
without changes.</t>

<t>For example, given the URI:</t>

<figure><artwork type="example"><![CDATA[
secret-token:E92FB7EB-D882-47A4-A265-A0B6135DC842%20foo
]]></artwork></figure>

<t>This string (character-for-character, case-sensitive) will both be issued by the token authority, and required for later access. Therefore, if the example above were used as a bearer token in <xref target="RFC6750"/>, a client might send:</t>

<figure><artwork type="example"><![CDATA[
GET /authenticated/stuff HTTP/1.1
Host: www.example.com
Authorization: Bearer secret-token:E92FB7EB-D882-47A4-A265-A0B6135DC842%20foo
]]></artwork></figure>

</section>
<section anchor="iana-considerations" title="IANA Considerations">

<t>This document registers the following value in the URI Scheme registry:</t>

<t><list style="symbols">
  <t>Scheme name: secret-token</t>
  <t>Status: provisional</t>
  <t>Applications / protocols that use this scheme: none yet</t>
  <t>Contact: iesg@iesg.org</t>
  <t>Change Controller: IESG</t>
  <t>References: [this document]</t>
</list></t>

</section>
<section anchor="security-considerations" title="Security Considerations">

<t>The token ABNF rule allows tokens as small as one character. This is not recommended practice; applications should evaluate their requirements for entropy and issue tokens correspondingly.</t>

<t>This URI scheme is intended to reduce the incidence of accidental disclosure; it cannot prevent intentional disclosure.</t>

<t>If it is difficult to correctly handle secret material, or unclear as to what the appropriate handling is, users might choose to obfuscate their secret tokens in order to evade detection (for example, removing the URI scheme for storage). Clear guidelines and helpful tools are good mitigations here.</t>

</section>


  </middle>

  <back>

    <references title='Normative References'>





<reference  anchor="RFC2119" target='https://www.rfc-editor.org/info/rfc2119'>
<front>
<title>Key words for use in RFCs to Indicate Requirement Levels</title>
<author initials='S.' surname='Bradner' fullname='S. Bradner'><organization /></author>
<date year='1997' month='March' />
<abstract><t>In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t></abstract>
</front>
<seriesInfo name='BCP' value='14'/>
<seriesInfo name='RFC' value='2119'/>
<seriesInfo name='DOI' value='10.17487/RFC2119'/>
</reference>



<reference  anchor="RFC8174" target='https://www.rfc-editor.org/info/rfc8174'>
<front>
<title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
<author initials='B.' surname='Leiba' fullname='B. Leiba'><organization /></author>
<date year='2017' month='May' />
<abstract><t>RFC 2119 specifies common key words that may be used in protocol  specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the  defined special meanings.</t></abstract>
</front>
<seriesInfo name='BCP' value='14'/>
<seriesInfo name='RFC' value='8174'/>
<seriesInfo name='DOI' value='10.17487/RFC8174'/>
</reference>



<reference  anchor="RFC5234" target='https://www.rfc-editor.org/info/rfc5234'>
<front>
<title>Augmented BNF for Syntax Specifications: ABNF</title>
<author initials='D.' surname='Crocker' fullname='D. Crocker' role='editor'><organization /></author>
<author initials='P.' surname='Overell' fullname='P. Overell'><organization /></author>
<date year='2008' month='January' />
<abstract><t>Internet technical specifications often need to define a formal syntax.  Over the years, a modified version of Backus-Naur Form (BNF), called Augmented BNF (ABNF), has been popular among many Internet specifications.  The current specification documents ABNF. It balances compactness and simplicity with reasonable representational power.  The differences between standard BNF and ABNF involve naming rules, repetition, alternatives, order-independence, and value ranges.  This specification also supplies additional rule definitions and encoding for a core lexical analyzer of the type common to several Internet specifications.  [STANDARDS-TRACK]</t></abstract>
</front>
<seriesInfo name='STD' value='68'/>
<seriesInfo name='RFC' value='5234'/>
<seriesInfo name='DOI' value='10.17487/RFC5234'/>
</reference>



<reference  anchor="RFC3986" target='https://www.rfc-editor.org/info/rfc3986'>
<front>
<title>Uniform Resource Identifier (URI): Generic Syntax</title>
<author initials='T.' surname='Berners-Lee' fullname='T. Berners-Lee'><organization /></author>
<author initials='R.' surname='Fielding' fullname='R. Fielding'><organization /></author>
<author initials='L.' surname='Masinter' fullname='L. Masinter'><organization /></author>
<date year='2005' month='January' />
<abstract><t>A Uniform Resource Identifier (URI) is a compact sequence of characters that identifies an abstract or physical resource.  This specification defines the generic URI syntax and a process for resolving URI references that might be in relative form, along with guidelines and security considerations for the use of URIs on the Internet.  The URI syntax defines a grammar that is a superset of all valid URIs, allowing an implementation to parse the common components of a URI reference without knowing the scheme-specific requirements of every possible identifier.  This specification does not define a generative grammar for URIs; that task is performed by the individual specifications of each URI scheme.  [STANDARDS-TRACK]</t></abstract>
</front>
<seriesInfo name='STD' value='66'/>
<seriesInfo name='RFC' value='3986'/>
<seriesInfo name='DOI' value='10.17487/RFC3986'/>
</reference>



<reference  anchor="RFC3629" target='https://www.rfc-editor.org/info/rfc3629'>
<front>
<title>UTF-8, a transformation format of ISO 10646</title>
<author initials='F.' surname='Yergeau' fullname='F. Yergeau'><organization /></author>
<date year='2003' month='November' />
<abstract><t>ISO/IEC 10646-1 defines a large character set called the Universal Character Set (UCS) which encompasses most of the world's writing systems.  The originally proposed encodings of the UCS, however, were not compatible with many current applications and protocols, and this has led to the development of UTF-8, the object of this memo.  UTF-8 has the characteristic of preserving the full US-ASCII range, providing compatibility with file systems, parsers and other software that rely on US-ASCII values but are transparent to other values.  This memo obsoletes and replaces RFC 2279.</t></abstract>
</front>
<seriesInfo name='STD' value='63'/>
<seriesInfo name='RFC' value='3629'/>
<seriesInfo name='DOI' value='10.17487/RFC3629'/>
</reference>




    </references>

    <references title='Informative References'>





<reference  anchor="RFC6750" target='https://www.rfc-editor.org/info/rfc6750'>
<front>
<title>The OAuth 2.0 Authorization Framework: Bearer Token Usage</title>
<author initials='M.' surname='Jones' fullname='M. Jones'><organization /></author>
<author initials='D.' surname='Hardt' fullname='D. Hardt'><organization /></author>
<date year='2012' month='October' />
<abstract><t>This specification describes how to use bearer tokens in HTTP requests to access OAuth 2.0 protected resources.  Any party in possession of a bearer token (a &quot;bearer&quot;) can use it to get access to the associated resources (without demonstrating possession of a cryptographic key).  To prevent misuse, bearer tokens need to be protected from disclosure in storage and in transport.   [STANDARDS-TRACK]</t></abstract>
</front>
<seriesInfo name='RFC' value='6750'/>
<seriesInfo name='DOI' value='10.17487/RFC6750'/>
</reference>




    </references>


<section anchor="acknowledgements" title="Acknowledgements">

<t>The definition of bearer tokens is from <xref target="RFC6750"/>.</t>

</section>


  </back>

<!-- ##markdown-source:
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
g+R3tcV58U0VAAA=

-->

</rfc>

